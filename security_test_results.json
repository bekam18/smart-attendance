{
  "payload_tests": {
    "sql_injection": [
      {
        "payload": "' OR '1'='1",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' OR 1=1--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' OR 1=1#",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' OR 1=1/*",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "admin'--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "admin'#",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "admin'/*",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' UNION SELECT * FROM users--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' UNION SELECT username, password FROM users--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' UNION SELECT 1,2,3,4,5--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' AND (SELECT COUNT(*) FROM users) > 0--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' AND (SELECT SUBSTRING(username,1,1) FROM users LIMIT 1)='a'--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "'; WAITFOR DELAY '00:00:05'--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' OR SLEEP(5)--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' OR BENCHMARK(1000000,MD5(1))--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' AND EXTRACTVALUE(1, CONCAT(0x7e, (SELECT version()), 0x7e))--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' AND (SELECT * FROM (SELECT COUNT(*),CONCAT(version(),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "'; DROP TABLE users;--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "'; INSERT INTO users VALUES ('hacker', 'password');--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "'; UPDATE users SET password='hacked' WHERE username='admin';--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' INTO OUTFILE '/tmp/test.txt'--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' UNION SELECT LOAD_FILE('/etc/passwd')--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' AND ASCII(SUBSTRING((SELECT password FROM users LIMIT 1),1,1)) > 65--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "' AND ORD(MID((SELECT IFNULL(CAST(username AS CHAR),0x20) FROM users ORDER BY id LIMIT 1),1,1)) > 97--",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      }
    ],
    "xss": [
      {
        "payload": "<script>alert('XSS')</script>",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "javascript:alert('XSS')",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "<img src=x onerror=alert('XSS')>",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "<svg onload=alert('XSS')>",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "';alert('XSS');//",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      }
    ],
    "command_injection": [
      {
        "payload": "; ls -la",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "| whoami",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "&& cat /etc/passwd",
        "blocked": true,
        "status_code": 400,
        "response": "{\"error\":\"Invalid input detected\",\"message\":\"Input contains potentially malicious content\"}\n"
      },
      {
        "payload": "`id`",
        "blocked": false,
        "status_code": 401,
        "response": "{\"error\":\"Invalid credentials\"}\n"
      },
      {
        "payload": "$(whoami)",
        "blocked": false,
        "status_code": 401,
        "response": "{\"error\":\"Invalid credentials\"}\n"
      }
    ]
  },
  "api_tests": {
    "/api/admin/users": {
      "blocked": false,
      "status_code": 404,
      "response": "{\"error\":\"Not found\"}\n"
    },
    "/api/students/register-face": {
      "blocked": false,
      "status_code": 404,
      "response": "{\"error\":\"Not found\"}\n"
    },
    "/api/attendance/records": {
      "blocked": false,
      "status_code": 404,
      "response": "{\"error\":\"Not found\"}\n"
    }
  },
  "rate_limiting": {
    "total_requests": 50,
    "blocked_requests": 0,
    "duration_seconds": 0.8428633213043213,
    "rate_limiting_active": false
  }
}